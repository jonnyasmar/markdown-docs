/* Import font families with proper weight variants */
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Garamond:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Book+Antiqua:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;700&display=swap');

/* Import Radix UI colors for dark theme */
@import '@radix-ui/colors/slate.css';
@import '@radix-ui/colors/slate-dark.css';
@import '@radix-ui/colors/gray.css';
@import '@radix-ui/colors/gray-dark.css';

/* Ensure system fonts are loaded with proper weights - CSS font synthesis fallback */
* {
  font-synthesis: weight style;
}

.mdx-editor-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: var(--vscode-editor-background);
  color: var(--vscode-editor-foreground);
  margin: 0;
  padding: 0;
  /* Prevent scroll chaining to VS Code editor */
  overscroll-behavior: contain;
  overflow: hidden; /* Container manages scrolling through child elements */
}

.mdx-editor {
  /* Base colors - main backgrounds and surfaces */
  --baseBase: var(--vscode-editor-background);
  --baseBgSubtle: var(--vscode-editorWidget-background);
  --baseBg: var(--vscode-input-background);
  --baseBgHover: var(--vscode-list-hoverBackground);
  --baseBgActive: var(--vscode-input-border);
  --basePageBg: var(--vscode-editor-background);
  --baseLine: var(--vscode-input-border);
  --baseBorder: var(--vscode-input-border);
  --baseBorderHover: var(--vscode-inputOption-activeBorder);
  --baseSolid: var(--vscode-button-background);
  --baseSolidHover: var(--vscode-button-hoverBackground);
  --baseText: var(--vscode-editor-foreground);
  --baseTextContrast: var(--vscode-editor-foreground);

  /* Accent colors - use proper VS Code widget borders instead of button borders */
  --accentBase: var(--vscode-button-secondaryBackground);
  --accentBgSubtle: var(--vscode-button-secondaryBackground);
  --accentBg: var(--vscode-button-secondaryBackground);
  --accentBgHover: var(--vscode-button-secondaryHoverBackground);
  --accentBgActive: var(--vscode-button-secondaryHoverBackground);
  --accentLine: var(--vscode-widget-border);
  --accentBorder: var(--vscode-input-border);
  --accentBorderHover: var(--vscode-widget-border);
  --accentSolid: var(--vscode-button-secondaryBackground);
  --accentSolidHover: var(--vscode-button-secondaryHoverBackground);
  --accentText: var(--vscode-button-secondaryForeground);
  --accentTextContrast: var(--vscode-button-secondaryForeground);

  /* Layout and structure */
  border: none;
  height: 100%;
  display: flex;
  flex-direction: column;
}

[role='checkbox'] {
  --accentSolid: var(--vscode-editorWidget-border);
  --accentBorder: var(--vscode-editorWidget-border);
  --baseBorder: var(--vscode-editorWidget-border);
}

[role='checkbox'][checked='true'] {
  --accentSolid: var(--vscode-editorWidget-border);
}

/* Proper MDXEditor theming using semantic variables and VS Code integration */
.mdx-editor.dark-theme {
  /* Admonition colors - Dark theme */
  --admonitionTipBg: rgba(54, 163, 247, 0.15);
  --admonitionTipBorder: #36a3f7;

  --admonitionInfoBg: rgba(0, 184, 217, 0.15);
  --admonitionInfoBorder: #00b8d9;

  --admonitionCautionBg: rgba(255, 184, 0, 0.15);
  --admonitionCautionBorder: #ffb800;

  --admonitionDangerBg: rgba(250, 82, 82, 0.15);
  --admonitionDangerBorder: #fa5252;

  --admonitionNoteBg: var(--vscode-editorWidget-background);
  --admonitionNoteBorder: rgba(255, 255, 255, 0.2);
}

/* Light theme variables for MDXEditor */
.mdx-editor.light-theme {
  /* Admonition colors - Light theme */
  --admonitionTipBg: rgba(54, 163, 247, 0.1);
  --admonitionTipBorder: #1e88e5;

  --admonitionInfoBg: rgba(0, 184, 217, 0.1);
  --admonitionInfoBorder: #0277bd;

  --admonitionCautionBg: rgba(255, 152, 0, 0.1);
  --admonitionCautionBorder: #f57c00;

  --admonitionDangerBg: rgba(244, 67, 54, 0.1);
  --admonitionDangerBorder: #d32f2f;

  --admonitionNoteBg: var(--vscode-editorWidget-background);
  --admonitionNoteBorder: rgba(0, 0, 0, 0.2);
}

/* Content styling - clean approach without heavy !important usage */
.mdx-content {
  overscroll-behavior: contain;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  padding: 8px 20px;
  margin: 0;
  min-height: 100%;
  overflow-y: auto;
  flex: 1;
}

/* Only target text elements that need font override */
.mdx-content h1,
.mdx-content h2,
.mdx-content h3,
.mdx-content h4,
.mdx-content h5,
.mdx-content h6,
.mdx-content p,
.mdx-content li,
.mdx-content td,
.mdx-content th {
  font-family: Arial, Helvetica, sans-serif;
}

/* Heading styling - reduced margins for better layout */
.mdx-content h1,
.mdx-content h2,
.mdx-content h3,
.mdx-content h4,
.mdx-content h5,
.mdx-content h6 {
  margin-top: 0.8em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

.mdx-content h1 {
  font-size: 1.6em;
}
.mdx-content h2 {
  font-size: 1.4em;
}
.mdx-content h3 {
  font-size: 1.2em;
}
.mdx-content h4 {
  font-size: 1.1em;
}
.mdx-content h5 {
  font-size: 1.05em;
}
.mdx-content h6 {
  font-size: 1em;
}

.mdx-content p {
  font-size: 14px;
}

.prose :where(p):not(:where([class~='not-prose'] *)) {
  margin-top: 0.6em;
  margin-bottom: 0.6em;
}

.mdx-content strong {
  font-weight: bold;
  /* Ensure system fonts load with proper bold weights */
  font-synthesis: weight style;
}

/* Inline code styling */
.mdx-content code {
  background: var(--vscode-textCodeBlock-background);
  color: var(--vscode-editor-foreground);
  padding: 2px 4px;
  border-radius: 3px;
  font-size: 13px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* Pre-formatted code blocks - auto-sizing to content */
.mdx-content pre {
  background: var(--vscode-textCodeBlock-background);
  color: var(--vscode-editor-foreground);
  padding: 12px;
  border-radius: 4px;
  overflow-x: auto;
  font-size: 13px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  min-height: auto;
  height: auto;
  max-height: none;
}

/* CODE BLOCKS: Single focused solution for CodeMirror height control */
.mdx-content .cm-editor {
  background: var(--vscode-textCodeBlock-background);
  color: var(--vscode-editor-foreground);
  border-radius: 4px;
  border: 1px solid var(var(--vscode-editorWidget-border), rgba(128, 128, 128, 0.2));
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.4;
  /* Force compact sizing for code blocks */
  min-height: fit-content;
  height: fit-content;
  max-height: fit-content;
}

.mdx-content .cm-editor .cm-content {
  min-height: fit-content;
  height: fit-content;
  max-height: fit-content;
  padding: 8px 12px;
}

.mdx-content .cm-editor .cm-scroller {
  min-height: fit-content;
  height: fit-content;
  max-height: fit-content;
}

/* Override any inline styles that might be applied by JavaScript */
.mdx-content .cm-editor[style],
.mdx-content .cm-editor .cm-content[style],
.mdx-content .cm-editor .cm-scroller[style] {
  height: fit-content !important;
  min-height: fit-content !important;
  max-height: fit-content !important;
}

/* Preserve mermaid auto-sizing behavior - exclude from height restrictions */
.mdx-content .cm-editor[data-language='mermaid'],
.mdx-content .cm-editor[data-language='mermaid'] .cm-content,
.mdx-content .cm-editor[data-language='mermaid'] .cm-scroller,
.mdx-content pre[data-language='mermaid'],
.mdx-content .mermaid-container {
  height: auto !important;
  min-height: 200px !important;
  max-height: none !important;
}

.mdx-content .cm-editor .cm-line {
  color: var(--vscode-editor-foreground);
  font-family: inherit; /* Inherit monospace from cm-editor */
  font-size: inherit;
}

/* Additional CodeMirror UI elements */
.mdx-content .cm-editor .cm-cursor {
  border-left-color: var(--vscode-editorCursor-foreground);
}

.mdx-content .cm-editor.cm-focused {
  outline: 1px solid var(--vscode-focusBorder);
  outline-offset: -1px;
}

.mdx-content .cm-editor .cm-selectionBackground {
  background: var(--vscode-editor-selectionBackground);
}

.mdx-content .cm-editor .cm-activeLine {
  background: var(--vscode-editor-lineHighlightBackground);
}

/* Fix 1: Differentiate line highlight from selection background */
.mdx-content .cm-editor .cm-activeLine {
  background: rgba(255, 255, 255, 0.04) !important;
}

/* Dark theme specific line highlight - slightly different from selection */
.dark-theme .mdx-content .cm-editor .cm-activeLine {
  background: rgba(255, 255, 255, 0.06) !important;
}

/* Fix 2: Theme-aware bracket matching instead of stark white */
.mdx-content .cm-editor .cm-matchingBracket {
  background: var(--vscode-editor-findMatchHighlightBackground) !important;
  color: inherit !important;
  border: 1px solid var(--vscode-editor-findMatchBorder) !important;
  border-radius: 2px !important;
}

.mdx-content .cm-editor .cm-nonmatchingBracket {
  background: var(--vscode-inputValidation-errorBackground) !important;
  color: var(--vscode-inputValidation-errorForeground) !important;
  border: 1px solid var(--vscode-inputValidation-errorBorder) !important;
  border-radius: 2px !important;
}

.mdx-content .cm-editor .cm-gutters {
  background: var(--vscode-editorGutter-background);
  border-right: 1px solid var(--vscode-editorGutter-border);
  color: var(--vscode-editorLineNumber-foreground);
}

/* Syntax highlighting using VS Code semantic tokens - clean approach */
.cm-editor .tok-keyword {
  color: #569cd6;
}
.cm-editor .tok-string {
  color: #ce9178;
}
.cm-editor .tok-comment {
  color: #6a9955;
  font-style: italic;
}
.cm-editor .tok-function {
  color: #dcdcaa;
}
.cm-editor .tok-number {
  color: #b5cea8;
}
.cm-editor .tok-operator {
  color: #d4d4d4;
}
.cm-editor .tok-variable {
  color: #9cdcfe;
}
.cm-editor .tok-property {
  color: #9cdcfe;
}
.cm-editor .tok-punctuation {
  color: #d4d4d4;
}

/* CodeMirror syntax highlighting classes */
.cm-editor .cm-keyword {
  color: #569cd6;
}
.cm-editor .cm-string {
  color: #ce9178;
}
.cm-editor .cm-comment {
  color: #6a9955;
  font-style: italic;
}
.cm-editor .cm-variableName {
  color: #9cdcfe;
}
.cm-editor .cm-number {
  color: #b5cea8;
}

.mdx-content ul,
.mdx-content ol {
  margin-bottom: 0.6em;
  padding-left: 1.5em;
}

.mdx-content li {
  margin-bottom: 0.2em;
  color: var(--vscode-editor-foreground);
}

/* Toolbar dropdown styling */
.mdx-editor .mdxeditor-toolbar select,
.mdx-editor .mdxeditor-toolbar [role='combobox'],
.mdx-editor .mdxeditor-select-content {
  background: var(--vscode-dropdown-background);
  color: var(--vscode-dropdown-foreground);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 0;
}

/* Radix UI Select component theming */
.mdxeditor-select-content {
  background: var(--vscode-dropdown-background);
  color: var(--vscode-dropdown-foreground);
  border: 1px solid var(--vscode-dropdown-border);
}

/* Code block language selector styling - fix black/white buttons */
.mdxeditor-code-block-language-select-button,
button[class*='_selectTrigger_'],
button[role='combobox'][aria-label='Language'],
.cm-editor .mdxeditor-language-selector,
.cm-editor button[data-language-selector],
.cm-editor .cm-editor-language-selector,
[data-code-block-editor] .mdxeditor-language-selector,
[data-code-block-editor] button {
  background: var(--vscode-button-secondaryBackground) !important;
  color: var(--vscode-button-secondaryForeground) !important;
  border: 1px solid var(--vscode-input-border) !important;
  border-radius: 4px !important;
  font-size: 12px !important;
  padding: 4px 8px !important;
  width: 100px;
}

button[class*='_selectTrigger_'][aria-label='Font'] {
  width: 136px;
}

.toolbar-group.display-font-group [role='combobox'] {
  width: 110px;
}

/* Language selector hover state */
.mdxeditor-code-block-language-select-button:hover,
button[class*='_selectTrigger_']:hover,
button[role='combobox'][aria-label='Language']:hover,
.cm-editor .mdxeditor-language-selector:hover,
.cm-editor button[data-language-selector]:hover,
[data-code-block-editor] button:hover {
  background: var(--vscode-button-secondaryHoverBackground) !important;
}

/* Fix CodeMirror active line gutter elements with inline styles */
.cm-editor .cm-gutterElement.cm-activeLineGutter {
  background: var(--vscode-editor-lineHighlightBackground) !important;
  color: var(--vscode-editorLineNumber-activeForeground) !important;
}

/* Fix any select triggers in code blocks */
.cm-editor [data-radix-select-trigger],
[data-code-block-editor] [data-radix-select-trigger],
.mdxeditor-code-block [data-radix-select-trigger] {
  background: var(--vscode-button-secondaryBackground) !important;
  color: var(--vscode-button-secondaryForeground) !important;
  border: 1px solid var(--vscode-editorWidget-border) !important;
  border-radius: 4px !important;
}

/* Fix dropdown content that renders in portals */
[data-radix-select-content],
[data-radix-select-viewport],
[data-radix-popper-content-wrapper] [data-radix-select-content] {
  background: var(--vscode-dropdown-background) !important;
  color: var(--vscode-dropdown-foreground) !important;
  border: 1px solid var(--vscode-dropdown-border) !important;
  border-radius: 6px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

[data-radix-select-viewport] {
  max-height: 300px !important;
  overflow-y: auto !important;
  scrollbar-width: auto !important;
  -ms-overflow-style: auto !important;
  -webkit-overflow-scrolling: touch !important;
}

[data-radix-select-viewport]::-webkit-scrollbar {
  display: block !important;
}

/* Fix dropdown items */
[data-radix-select-item],
[data-radix-select-content] [role='option'] {
  background: transparent !important;
  color: var(--vscode-dropdown-foreground) !important;
  padding: 8px 12px !important;
  cursor: pointer !important;
  border-radius: 4px !important;
  margin: 2px !important;
}

[data-radix-select-item]:hover,
[data-radix-select-content] [role='option']:hover {
  background: var(--vscode-list-hoverBackground) !important;
}

[data-radix-select-item][data-highlighted],
[data-radix-select-content] [role='option'][data-highlighted] {
  background: var(--vscode-list-activeSelectionBackground) !important;
  color: var(--vscode-list-activeSelectionForeground) !important;
}

/* Layout structure */
.mdx-editor-with-sidebar {
  flex: 1;
  display: flex;
  overflow: hidden;
  position: relative;
  min-height: 0; /* Allow flex shrinking */
}

.mdx-editor-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  min-width: 0; /* Allows flex item to shrink */
}

/* MDXEditor content editable styling - using semantic variables */
.mdx-editor .mdxeditor-root-contenteditable {
  background: var(--baseBase);
  color: var(--baseText);
  overflow-y: auto !important;
  overflow-x: hidden !important;
  flex: 1; /* Take remaining space after toolbar */
  min-height: 0; /* Allow flex item to shrink */
  padding: 0;
  margin: 0;
  min-height: 0;
  max-height: none;
}

[class*='_rootContentEditableWrapper_'] {
  flex: 1 !important;
  min-height: 0 !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  height: auto !important;
  max-height: none !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Also target the diff-source wrapper that contains the editor */
.mdxeditor-diff-source-wrapper {
  flex: 1 !important;
  min-height: 0 !important;
  display: flex !important;
  flex-direction: column !important;
}

.mdxeditor-rich-text-editor {
  flex: 1 !important;
  min-height: 0 !important;
  flex-direction: column !important;
}

.mdxeditor-rich-text-editor[style='display: block;'] {
  display: flex !important;
}

[class*='_diffSourceToggleWrapper_'] {
  margin: 0 auto !important;
}

/* Fix source editor (CodeMirror) scrolling */
.mdxeditor-source-editor {
  flex: 1 !important;
  min-height: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;
}

.mdxeditor-source-editor .cm-editor {
  flex: 1 !important;
  min-height: 0 !important;
  height: auto !important;
  max-height: none !important;
  overflow: hidden !important;
}

.mdxeditor-source-editor .cm-scroller {
  flex: 1 !important;
  min-height: 0 !important;
  overflow: auto !important;
  height: auto !important;
  max-height: none !important;
}

/* MDXEditor layout - ensure proper flex sizing */
.mdx-editor {
  flex: 1; /* Take remaining space after toolbar */
  display: flex;
  flex-direction: column;
  min-height: 0; /* Allow flex item to shrink below content size */
}

/* Toolbar styling with proper spacing */
.mdx-editor .mdxeditor-toolbar {
  flex-shrink: 0;
  min-height: 44px;
  height: auto;
  max-height: none;
  overflow: visible; /* Allow overflow menu to appear outside toolbar */
  flex-wrap: nowrap;
  padding: 8px;
  border-radius: 0;
  position: relative; /* Enable absolute positioning for overflow menu */
}

/* Responsive toolbar layout */
.responsive-toolbar {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 0;
  position: relative;

  /* Responsive breakpoint thresholds - adjust these to refine when groups hide */
  --breakpoint-font-style: 1200px; /* Font selection dropdown */
  --breakpoint-blocks: 1000px; /* Codeblock, Link, Table, Thematic Break */
  --breakpoint-lists: 850px; /* Lists toggle */
  --breakpoint-formatting: 700px; /* Bold, Italic, Underline */
  --breakpoint-display-font: 550px; /* Block type select (H1, H2, etc) */
  --breakpoint-undo-redo: 400px; /* Undo/Redo */

  /* Width sizing variables - adjust these to change component sizes */
  --text-style-width: 96px; /* 120px * 0.8 = 20% reduction */
  --search-width: 130px; /* 200px * 0.8 = 20% reduction */
}

.toolbar-main {
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 0;
}

.toolbar-main.source-toolbar {
  width: 100%;
  justify-content: end;
  align-items: end;
}

.toolbar-main.source-toolbar [class*='_diffSourceToggleWrapper_'] {
  margin: 0 !important;
}

.toolbar-group {
  display: flex;
  align-items: center;
}

.toolbar-search {
  flex-shrink: 0;
}

.toolbar-overflow {
  position: relative;
  flex-shrink: 0;
}

.overflow-trigger {
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border: 1px solid var(--vscode-input-border);
  border-radius: 4px;
  padding: 6px 8px;
  cursor: pointer;
  font-size: 14px;
  line-height: 1;
  min-width: 32px;
  text-align: center;
  display: none; /* Hidden by default, shown when needed */
}

.overflow-trigger.visible {
  display: block;
}

.overflow-trigger:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

/* Toolbar-based overflow menu (no portal) */
.overflow-menu {
  position: absolute;
  top: 100%;
  right: 0;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  max-width: 80vw;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.15s ease-out;
  pointer-events: none;
}

.overflow-menu.visible {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
  pointer-events: all;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.overflow-menu-content {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 8px;
  flex-wrap: wrap;
}

/* Overflow menu groups - controlled by JavaScript hiddenGroups state */
.overflow-group {
  display: flex;
  align-items: center;
  gap: 4px;
  margin: 0 auto;
}

.overflow-book-view {
  padding: 0 40px;
}

.overflow-separator {
  color: var(--vscode-descriptionForeground);
  margin: 0 8px;
  font-size: 12px;
  opacity: 0.8;
  font-weight: normal;
  user-select: none;
  pointer-events: none;
}

/* Text style and search field widths using CSS variables - stronger selectors */
.responsive-toolbar .font-style-group [data-radix-select-trigger],
.responsive-toolbar .overflow-font-style [data-radix-select-trigger] {
  min-width: var(--text-style-width) !important;
  width: var(--text-style-width) !important;
}

.responsive-toolbar .search-input-wrapper {
  min-width: var(--search-width) !important;
  max-width: var(--search-width) !important;
}

/* Override any conflicting rules */
.mdx-editor .mdxeditor-toolbar [data-radix-select-trigger] {
  min-width: var(--text-style-width) !important;
}

/* JavaScript-controlled responsive behavior - no more media queries needed */

/* Comments Sidebar - positioned on the right side */
.comments-sidebar {
  width: 320px;
  min-width: 280px;
  max-width: 600px;
  background: var(--vscode-sideBar-background);
  border-left: 1px solid var(--vscode-sideBar-border);
  display: flex;
  flex-direction: column;
  position: relative;
  height: 100%;
}

.sidebar-resize-handle {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: transparent;
  cursor: col-resize;
  z-index: 100;
}

.sidebar-resize-handle:hover {
  background: var(--vscode-sash-hoverBorder);
}

.sidebar-resize-handle:active {
  background: var(--vscode-focusBorder);
}

.comments-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 11px 20px;
  border-bottom: 1px solid var(--vscode-sideBar-border);
}

.comments-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--vscode-sideBar-foreground);
}

.sidebar-close {
  background: transparent;
  border: none;
  color: var(--vscode-sideBar-foreground);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 16px;
}

.sidebar-close:hover {
  background: var(--vscode-button-hoverBackground);
}

.comments-list {
  flex: 1;
  padding: 16px 20px;
  overflow-y: auto;
}

.no-comments {
  text-align: center;
  color: var(--vscode-descriptionForeground);
  margin-top: 60px;
}

.no-comments p {
  margin: 8px 0;
}

.help-text {
  font-size: 13px;
  opacity: 0.8;
}

.comment-item {
  background: var(--vscode-editorWidget-background);
  border: 1px solid var(--vscode-input-border);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 12px;
}

.comment-content {
  color: var(--vscode-editor-foreground);
  line-height: 1.4;
  margin-bottom: 8px;
  font-size: 14px;
}

.comment-anchor {
  font-size: 12px;
  color: var(--vscode-descriptionForeground);
  margin-bottom: 8px;
  font-style: italic;
}

.comment-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

.comment-action-btn {
  padding: 4px 8px;
  font-size: 12px;
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border: 1px solid var(--vscode-widget-border);
  border-radius: 4px;
  cursor: pointer;
}

.comment-action-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.comment-action-btn.delete {
  background: var(--vscode-errorBackground);
  color: var(--vscode-errorForeground);
}

.comment-action-btn.delete:hover {
  opacity: 0.8;
}

/* Custom search highlights (CSS Custom Highlight API) - controlled by our custom plugin */
/* General matches */
.mdx-editor ::highlight(mdx-search) {
  background-color: rgba(0, 200, 0, 0.35);
  color: inherit;
}
/* Focused/current match */
.mdx-editor ::highlight(mdx-focus-search) {
  background-color: rgba(255, 165, 0, 0.5);
  color: inherit;
}

/* Show comments button when sidebar is hidden */
.show-comments-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  transform: translateY(-50%);
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: 1px solid var(--vscode-widget-border);
  border-radius: 20px;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 14px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 100;
  opacity: 0.65;
}

.show-comments-btn:hover {
  opacity: 1;
}

/* TOC Sidebar - positioned on the left side */
.toc-sidebar {
  width: 320px;
  min-width: 280px;
  max-width: 600px;
  background: var(--vscode-sideBar-background);
  border-right: 1px solid var(--vscode-sideBar-border);
  position: relative;
  height: 100%;
  order: -1; /* Position before main editor */
}

.toc-header-wrapper {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--vscode-sideBar-border);
  background: var(--vscode-sideBarSectionHeader-background);
}

.toc-header-wrapper h3 {
  margin: 0;
  font-size: 13px;
  font-weight: 600;
  color: var(--vscode-sideBarTitle-foreground);
}

/* Show TOC button when sidebar is hidden */
.show-toc-btn {
  position: fixed;
  bottom: 20px;
  left: 20px;
  transform: translateY(-50%);
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: 1px solid var(--vscode-widget-border);
  border-radius: 20px;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 14px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 100;
  opacity: 0.65;
}

.show-toc-btn:hover {
  opacity: 1;
}

/* Floating comment button */
.floating-comment-button {
  position: absolute;
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: 1px solid var(--vscode-widget-border);
  border-radius: 50%;
  padding: 8px;
  font-size: 16px;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  opacity: 0;
  transform: translateY(-5px);
  transition: all 0.2s ease;
  pointer-events: none;
  font-weight: 500;
}

.floating-comment-button.visible {
  opacity: 1;
  pointer-events: all;
  transform: translateX(-100%);
}

.floating-comment-button:hover {
  background: var(--vscode-button-hoverBackground);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
}

/* Custom comment toggle button in toolbar */
.mdx-comment-button {
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border: 1px solid var(--vscode-widget-border);
  border-radius: 3px;
  padding: 6px 8px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.mdx-comment-button:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

/* Comment highlighting - theme-aware subtle inline indicators */
.comment-highlight,
mark {
  background-color: rgba(255, 255, 0, 0.25);
  padding: 1px 0px;
  margin: -1px 0px;
  transition: all 0.3s ease;
  color: inherit;
}

/* Lexical highlight text format styling */
.mdx-editor .text-highlight {
  background-color: rgba(255, 255, 0, 0.25);
  padding: 0;
  transition: all 0.3s ease;
  color: inherit;
  cursor: pointer;
}

.comment-highlight.editor-highlighted,
mark.editor-highlighted {
  background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.4);
  box-shadow: 0 0 8px rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.6);
  animation: pulse-editor-highlight 0.8s ease-out;
}

@keyframes pulse-editor-highlight {
  0% {
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.6);
    transform: scale(1);
  }
  50% {
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.5);
    transform: scale(1.02);
  }
  100% {
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.4);
    transform: scale(1);
  }
}

/* Persistent focus state for inline comments - with initial pulse animation */
.comment-highlight.focused,
mark.focused {
  background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.3);
  border-radius: 2px;
  animation: highlight-pulse 0.6s ease-out;
  transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  padding: 1px 0px;
  margin: -1px 0px;
  position: relative;
}

@keyframes highlight-pulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.4);
  }
  50% {
    transform: scale(1.02);
    box-shadow: 0 0 0 4px rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.2);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0);
  }
}

.comment-item.highlighted,
mark.highlighted {
  background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.15);
  border-left: 3px solid var(--vscode-focusBorder);
  transform: translateX(4px);
  box-shadow: 0 2px 8px rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.2);
  transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  animation: pulse-highlight 0.6s ease-out;
}

@keyframes pulse-highlight {
  0% {
    transform: translateX(0px) scale(1);
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.3);
  }
  50% {
    transform: translateX(6px) scale(1.02);
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.25);
  }
  100% {
    transform: translateX(4px) scale(1);
    background-color: rgba(var(--vscode-focusBorder-rgba, 0, 123, 255), 0.15);
  }
}

.comment-item {
  transition: all 0.3s ease;
}

/* Font selection styling */
.font-selector {
  background: var(--vscode-dropdown-background);
  color: var(--vscode-dropdown-foreground);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 3px;
  padding: 4px 8px;
  font-size: 12px;
  min-width: 120px;
}

/* Font application - using higher specificity instead of !important */
.mdx-content.font-arial h1,
.mdx-content.font-arial h2,
.mdx-content.font-arial h3,
.mdx-content.font-arial h4,
.mdx-content.font-arial h5,
.mdx-content.font-arial h6,
.mdx-content.font-arial p,
.mdx-content.font-arial li,
.mdx-content.font-arial td {
  font-family: Arial, sans-serif;
}

.mdx-content.font-times-new-roman h1,
.mdx-content.font-times-new-roman h2,
.mdx-content.font-times-new-roman h3,
.mdx-content.font-times-new-roman h4,
.mdx-content.font-times-new-roman h5,
.mdx-content.font-times-new-roman h6,
.mdx-content.font-times-new-roman p,
.mdx-content.font-times-new-roman li,
.mdx-content.font-times-new-roman td {
  font-family: 'Times New Roman', Times, serif;
}

.mdx-content.font-roboto h1,
.mdx-content.font-roboto h2,
.mdx-content.font-roboto h3,
.mdx-content.font-roboto h4,
.mdx-content.font-roboto h5,
.mdx-content.font-roboto h6,
.mdx-content.font-roboto p,
.mdx-content.font-roboto li,
.mdx-content.font-roboto td {
  font-family: Roboto, Arial, sans-serif;
}

.mdx-content.font-georgia h1,
.mdx-content.font-georgia h2,
.mdx-content.font-georgia h3,
.mdx-content.font-georgia h4,
.mdx-content.font-georgia h5,
.mdx-content.font-georgia h6,
.mdx-content.font-georgia p,
.mdx-content.font-georgia li,
.mdx-content.font-georgia td {
  font-family: Georgia, serif;
}

.mdx-content.font-calibri h1,
.mdx-content.font-calibri h2,
.mdx-content.font-calibri h3,
.mdx-content.font-calibri h4,
.mdx-content.font-calibri h5,
.mdx-content.font-calibri h6,
.mdx-content.font-calibri p,
.mdx-content.font-calibri li,
.mdx-content.font-calibri td {
  font-family: Calibri, sans-serif;
}

.mdx-content.font-garamond h1,
.mdx-content.font-garamond h2,
.mdx-content.font-garamond h3,
.mdx-content.font-garamond h4,
.mdx-content.font-garamond h5,
.mdx-content.font-garamond h6,
.mdx-content.font-garamond p,
.mdx-content.font-garamond li,
.mdx-content.font-garamond td {
  font-family: Garamond, serif;
}

.mdx-content.font-book-antiqua h1,
.mdx-content.font-book-antiqua h2,
.mdx-content.font-book-antiqua h3,
.mdx-content.font-book-antiqua h4,
.mdx-content.font-book-antiqua h5,
.mdx-content.font-book-antiqua h6,
.mdx-content.font-book-antiqua p,
.mdx-content.font-book-antiqua li,
.mdx-content.font-book-antiqua td {
  font-family: 'Book Antiqua', serif;
}

/* Default Font - Uses the editor's configured font */
.mdx-content.font-default h1,
.mdx-content.font-default h2,
.mdx-content.font-default h3,
.mdx-content.font-default h4,
.mdx-content.font-default h5,
.mdx-content.font-default h6,
.mdx-content.font-default p,
.mdx-content.font-default li,
.mdx-content.font-default td {
  font-family: var(
    --vscode-editor-font-family,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    Helvetica,
    Arial,
    sans-serif
  );
}

/* Ensure bold variants work for default font */
.mdx-content.font-default strong,
.mdx-content.font-default b,
.mdx-content.font-default h1,
.mdx-content.font-default h2,
.mdx-content.font-default h3,
.mdx-content.font-default h4,
.mdx-content.font-default h5,
.mdx-content.font-default h6 {
  font-family: var(
    --vscode-editor-font-family,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    Helvetica,
    Arial,
    sans-serif
  );
  font-weight: bold;
}

.mdx-content.font-courier-new h1,
.mdx-content.font-courier-new h2,
.mdx-content.font-courier-new h3,
.mdx-content.font-courier-new h4,
.mdx-content.font-courier-new h5,
.mdx-content.font-courier-new h6,
.mdx-content.font-courier-new p,
.mdx-content.font-courier-new li,
.mdx-content.font-courier-new td {
  font-family: 'Courier New', Courier, monospace;
}

.mdx-content.font-open-sans h1,
.mdx-content.font-open-sans h2,
.mdx-content.font-open-sans h3,
.mdx-content.font-open-sans h4,
.mdx-content.font-open-sans h5,
.mdx-content.font-open-sans h6,
.mdx-content.font-open-sans p,
.mdx-content.font-open-sans li,
.mdx-content.font-open-sans td {
  font-family: 'Open Sans', Arial, sans-serif;
}

.mdx-content.font-lato h1,
.mdx-content.font-lato h2,
.mdx-content.font-lato h3,
.mdx-content.font-lato h4,
.mdx-content.font-lato h5,
.mdx-content.font-lato h6,
.mdx-content.font-lato p,
.mdx-content.font-lato li,
.mdx-content.font-lato td {
  font-family: 'Lato', Arial, sans-serif;
}

.mdx-content.font-montserrat h1,
.mdx-content.font-montserrat h2,
.mdx-content.font-montserrat h3,
.mdx-content.font-montserrat h4,
.mdx-content.font-montserrat h5,
.mdx-content.font-montserrat h6,
.mdx-content.font-montserrat p,
.mdx-content.font-montserrat li,
.mdx-content.font-montserrat td {
  font-family: 'Montserrat', Arial, sans-serif;
}

.mdx-content.font-source-sans-pro h1,
.mdx-content.font-source-sans-pro h2,
.mdx-content.font-source-sans-pro h3,
.mdx-content.font-source-sans-pro h4,
.mdx-content.font-source-sans-pro h5,
.mdx-content.font-source-sans-pro h6,
.mdx-content.font-source-sans-pro p,
.mdx-content.font-source-sans-pro li,
.mdx-content.font-source-sans-pro td {
  font-family: 'Source Sans Pro', Arial, sans-serif;
}

/* Font option styling in dropdown - target Radix UI structure */
/* Use JavaScript to add data attributes and target those */
.mdxeditor-select-content [role='option'] {
  /* Base styling for all options */
}

/* Target specific font options using their IDs or content */
[role='option'][aria-labelledby] span,
._selectItem_1e2ox_301 span {
  /* This will be overridden by JavaScript for specific fonts */
}

/* Fallback styles using more specific selectors */
[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(1) span {
  font-family: var(
    --vscode-editor-font-family,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    Helvetica,
    Arial,
    sans-serif
  ) !important; /* Default */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(2) span {
  font-family: Arial, sans-serif !important; /* Arial */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(3) span {
  font-family: 'Times New Roman', Times, serif !important; /* Times New Roman */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(4) span {
  font-family: Roboto, Arial, sans-serif !important; /* Roboto */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(5) span {
  font-family: Georgia, serif !important; /* Georgia */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(6) span {
  font-family: Calibri, sans-serif !important; /* Calibri */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(7) span {
  font-family: Garamond, serif !important; /* Garamond */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(8) span {
  font-family: 'Book Antiqua', serif !important; /* Book Antiqua */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(9) span {
  font-family: 'Courier New', monospace !important; /* Courier New */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(10) span {
  font-family: 'Open Sans', Arial, sans-serif !important; /* Open Sans */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(11) span {
  font-family: 'Lato', Arial, sans-serif !important; /* Lato */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(12) span {
  font-family: 'Montserrat', Arial, sans-serif !important; /* Montserrat */
}

[class*='font-'] div:has([role='option']:nth-child(13)) .mdxeditor-select-content [role='option']:nth-child(13) span {
  font-family: 'Source Sans Pro', Arial, sans-serif !important; /* Source Sans Pro */
}

/* Additional selectors for different dropdown implementations */
.font-option-default {
  font-family: var(
    --vscode-editor-font-family,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    Helvetica,
    Arial,
    sans-serif
  ) !important;
}

.font-option-arial {
  font-family: Arial, sans-serif !important;
}

.font-option-times-new-roman {
  font-family: 'Times New Roman', Times, serif !important;
}

.font-option-roboto {
  font-family: Roboto, Arial, sans-serif !important;
}

.font-option-georgia {
  font-family: Georgia, serif !important;
}

.font-option-calibri {
  font-family: Calibri, sans-serif !important;
}

.font-option-garamond {
  font-family: Garamond, serif !important;
}

.font-option-book-antiqua {
  font-family: 'Book Antiqua', serif !important;
}

.font-option-courier-new {
  font-family: 'Courier New', monospace !important;
}

.font-option-open-sans {
  font-family: 'Open Sans', Arial, sans-serif !important;
}

.font-option-lato {
  font-family: 'Lato', Arial, sans-serif !important;
}

.font-option-montserrat {
  font-family: 'Montserrat', Arial, sans-serif !important;
}

.font-option-source-sans-pro {
  font-family: 'Source Sans Pro', Arial, sans-serif !important;
}

[role='checkbox'] span:before {
  background-color: var(--vscode-editorWidget-background);
}

/* Individual page styling */
.book-page {
  /* 5.5" x 8.5" pages with 0.5" margins = 4.5" x 7.5" content area */
  width: 5.5in !important;
  height: 8.5in !important;
  background: white !important;
  margin-bottom: 0.5in !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
  border: 1px solid #ddd !important;
  position: relative !important;
  display: flex !important;
  flex-direction: column !important;
}

.book-page-content {
  padding: 0.5in !important;
  width: 4.5in !important;
  height: 7.5in !important;
  overflow: hidden !important;
  color: black !important;
  font-size: 12pt !important;
  line-height: 1.6 !important;
  box-sizing: border-box !important;
}

.book-page-number {
  position: absolute !important;
  bottom: 0.25in !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  font-size: 10pt !important;
  color: #666 !important;
  font-family: Arial, sans-serif !important;
}

/* MDXEditor toolbar custom components styling - improved contrast */
.mdx-editor .mdxeditor-toolbar button[data-state='on'],
.mdx-editor .mdxeditor-toolbar button.active {
  background-color: rgba(var(--vscode-foreground-rgba, 128, 128, 128), 0.15);
  color: var(--vscode-foreground);
  border: 1px solid rgba(var(--vscode-foreground-rgba, 128, 128, 128), 0.3);
}

.mdx-editor .mdxeditor-toolbar [data-radix-select-trigger] {
  background: var(--vscode-dropdown-background);
  color: var(--vscode-dropdown-foreground);
  border: 1px solid var(--vscode-dropdown-border);
  min-width: 120px;
}

/* Advanced scroll containment for all editor containers to prevent VS Code editor scrolling */
.ProseMirror,
.mdx-editor-content,
[contenteditable='true'] {
  overscroll-behavior: contain !important;
  /* Additional scroll containment properties */
  scroll-behavior: auto !important; /* Override smooth scroll that might cause issues */
  overflow-anchor: none !important; /* Prevent anchor scrolling */
}

/* Only apply bottom padding to the main editor content area, not code blocks or table cells */
.mdx-content[contenteditable='true'] {
  padding-bottom: 50vh !important;
  margin: 0 auto !important;
}

.custom-button {
  padding: 5px;
}

/* Additional webview isolation */
body {
  overscroll-behavior: contain !important;
  overflow-anchor: none !important;
}

/* Allow scrolling but prevent bubbling */
.mdx-editor-container .mdxeditor-root-contenteditable {
  overscroll-behavior: contain;
  overflow-y: auto !important;
  height: 100% !important;
  max-height: none !important;
}

/* Ensure search UI appears correctly with proper z-index */
.mdxeditor-popup-container {
  z-index: 9999 !important;
}

/* Style for search dialog if it appears */
.mdx-search-dialog,
.search-container,
[data-search-dialog] {
  z-index: 10000 !important;
  position: fixed !important;
  top: 10px !important;
  right: 10px !important;
  background: var(--vscode-dropdown-background) !important;
  border: 1px solid var(--vscode-dropdown-border) !important;
  border-radius: 4px !important;
  padding: 8px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5) !important;
}

/* Inline search component styles */
.inline-search-container {
  display: flex;
  align-items: center;
  margin: 0 8px;
}

.search-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  background: var(--vscode-input-background);
  border: 1px solid var(--vscode-input-border);
  border-radius: 4px;
  padding: 0 8px;
  min-width: 200px;
  height: 28px;
}

.search-icon {
  color: var(--vscode-descriptionForeground);
  margin-right: 6px;
  font-size: 12px;
  pointer-events: none;
}

.inline-search-input {
  background: transparent;
  border: none;
  color: var(--vscode-input-foreground);
  font-size: 13px;
  outline: none;
  flex: 1;
  height: 100%;
  padding: 0;
  width: 130px;
  padding-left: 30px;
  margin-left: -28px;
  padding-right: 20px;
  border-radius: 4px;
}

.inline-search-input::placeholder {
  color: var(--vscode-input-placeholderForeground);
}

.search-clear-btn {
  background: transparent;
  border: none;
  color: var(--vscode-descriptionForeground);
  cursor: pointer;
  padding: 0 4px;
  margin-left: -20px;
  font-size: 16px;
  line-height: 1;
  border-radius: 2px;
}

.search-clear-btn:hover {
  background: var(--vscode-button-hoverBackground);
  color: var(--vscode-button-foreground);
}

.search-match-info {
  position: absolute;
  right: 25px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 11px;
  color: var(--vscode-descriptionForeground);
  pointer-events: none;
  font-family: monospace;
}

/* Search highlighting styles - high specificity to override comment highlights */
.mdx-content .search-highlight,
.mdx-content * .search-highlight,
[contenteditable='true'] .search-highlight,
[contenteditable='true'] * .search-highlight {
  /* background-color: #32cd32 !important; */
  color: #000000 !important;
  padding: 1px 2px !important;
  border-radius: 3px !important;
  font-weight: inherit !important;
  font-style: inherit !important;
  text-decoration: none !important;
  box-shadow: 0 0 0 1px rgba(50, 205, 50, 0.3) !important;
  border: none !important;
}

/* Persistent focus state for sidebar comments - more subtle than highlight animation */
.comment-item.focused {
  background-color: rgba(0, 123, 255, 0.08) !important;
  border: 1px solid var(--vscode-editorWidget-border) !important;
  border-left: 4px solid var(--vscode-editorWidget-border) !important; /* Blue focus border, thicker */
  box-shadow: inset 0 0 0 1px rgba(0, 123, 255, 0.2);
  transform: translateX(2px);
}

/* Diff/Source mode styling */
.mdx-editor [data-diff-source-wrapper] button,
.mdx-editor .mdxeditor-diff-source-toggle-wrapper button {
  background: var(--vscode-button-secondaryBackground) !important;
  color: var(--vscode-button-secondaryForeground) !important;
  border: 1px solid var(--vscode-widget-border) !important;
  border-radius: 4px !important;
  font-size: 12px !important;
  padding: 4px 8px !important;
}

.mdx-editor [data-diff-source-wrapper] button:hover,
.mdx-editor .mdxeditor-diff-source-toggle-wrapper button:hover {
  background: var(--vscode-button-secondaryHoverBackground) !important;
}

.mdx-editor [data-diff-source-wrapper] button[data-state='on'],
.mdx-editor .mdxeditor-diff-source-toggle-wrapper button[data-state='on'] {
  background: var(--vscode-button-background) !important;
  color: var(--vscode-button-foreground) !important;
}

/* Source mode editor styling */
.mdx-editor .mdxeditor-source-editor {
  background: var(--vscode-editor-background) !important;
  color: var(--vscode-editor-foreground) !important;
  border: 1px solid var(--vscode-input-border) !important;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
}

.mdx-editor .mdxeditor-source-editor:focus {
  outline: 1px solid var(--vscode-focusBorder) !important;
  outline-offset: -1px !important;
}

/* Angle bracket text styling - for generic type annotations */
.angle-bracket-text {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace !important;
  background-color: rgba(100, 150, 200, 0.15) !important;
  border: 1px solid rgba(100, 150, 200, 0.3) !important;
  border-radius: 3px !important;
  padding: 1px 3px !important;
  font-size: 0.9em !important;
  color: #0066cc !important;
  font-weight: 500 !important;
}

/* Dark theme adjustments for angle bracket text */
.dark-theme .angle-bracket-text {
  background-color: rgba(100, 150, 255, 0.2) !important;
  border-color: rgba(100, 150, 255, 0.4) !important;
  color: #66aaff !important;
}

/* Style mathematical angle brackets (⟨⟩) used for display */
.mdx-content {
  font-feature-settings: 'liga' 0; /* Disable ligatures for cleaner angle bracket display */
}

/* Enhanced contrast for angle bracket content in different themes */
.mdx-content:has(span:contains('⟨')):has(span:contains('⟩')) {
  font-variant-ligatures: none;
}

/* Simple thematic break (HR) styling - reduced margin by 50% */
.mdx-content hr {
  border: none;
  height: 1px;
  background: var(--vscode-input-border, rgba(128, 128, 128, 0.3));
  margin: 1rem 0;
}

/* Blockquote styling - beautiful, clean quotes */
.mdx-content blockquote {
  margin: 1.5em 0;
  padding: 1em 1.2em;
  border-left: 4px solid var(--vscode-textLink-foreground, #007acc);
  background-color: var(--vscode-textBlockQuote-background, rgba(127, 127, 127, 0.1));
  font-style: italic;
  color: var(--vscode-textBlockQuote-foreground, var(--vscode-editor-foreground));
  border-radius: 0 4px 4px 0;
  position: relative;
}

.mdx-content blockquote p {
  margin: 0.5em 0;
  line-height: 1.6;
}

.mdx-content blockquote p:first-child {
  margin-top: 0;
}

.mdx-content blockquote p:last-child {
  margin-bottom: 0;
}

/* Attribution styling within blockquotes */
.mdx-content blockquote p:last-child:has(strong):before,
.mdx-content blockquote p:last-child:has(em):before {
  content: '— ';
  font-weight: normal;
  font-style: normal;
}

/* Dark theme adjustments */
.dark-theme .mdx-content blockquote {
  background-color: rgba(255, 255, 255, 0.05);
  border-left-color: var(--vscode-textLink-foreground, #4daafc);
}

/* ===== IMAGE UPLOAD DIALOG STYLING ===== */
/* EXTREMELY SPECIFIC targeting to avoid conflicts - target MDXEditor image dialog only */

.mdx-editor-container [role='not-dialog'],
.mdx-editor [role='not-dialog'] {
  background: var(--vscode-editor-background) !important;
  border: 1px solid var(--vscode-widget-border) !important;
}

/* Use more general approach - target any dialog with image-related content */
/* .mdx-editor-container [role="dialog"],
.mdx-editor [role="dialog"] {
  background: var(--vscode-editor-background) !important;
  border: 1px solid var(--vscode-widget-border) !important;
  border-radius: 8px !important;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5) !important;
  color: var(--vscode-foreground) !important;
  padding: 24px !important;
  min-width: 480px !important;
  max-width: 520px !important;
  max-height: 70vh !important;
  overflow: visible !important;
  font-family: var(--vscode-font-family) !important;
} */

/* Section labels and text */
.mdx-editor [role='not-dialog'] p,
.mdx-editor [role='not-dialog'] label {
  color: var(--vscode-foreground) !important;
  font-size: 14px !important;
  font-weight: 500 !important;
  margin: 0 0 8px 0 !important;
  display: block !important;
  line-height: 1.4 !important;
}

/* Better spacing between sections */
.mdx-editor [role='not-dialog'] > * + * {
  margin-top: 20px !important;
}

/* All input styling */
.mdx-editor [role='not-dialog'] input {
  background: var(--vscode-input-background) !important;
  color: var(--vscode-input-foreground) !important;
  border: 1px solid var(--vscode-input-border) !important;
  border-radius: 4px !important;
  padding: 12px !important;
  font-size: 14px !important;
  font-family: inherit !important;
  width: 100% !important;
  box-sizing: border-box !important;
  margin-bottom: 16px !important;
}

.mdx-editor [role='not-dialog'] input[type='file'] {
  background: var(--vscode-button-secondaryBackground) !important;
  color: var(--vscode-button-secondaryForeground) !important;
  cursor: pointer !important;
}

.mdx-editor [role='not-dialog'] input:focus {
  border-color: var(--vscode-focusBorder) !important;
  outline: none !important;
}

.mdx-editor [role='not-dialog'] input::placeholder {
  color: var(--vscode-input-placeholderForeground) !important;
}

/* Dialog buttons */
.mdx-editor [role='not-dialog'] button {
  background: var(--vscode-button-background) !important;
  color: var(--vscode-button-foreground) !important;
  border: 1px solid var(--vscode-widget-border) !important;
  border-radius: 4px !important;
  padding: 10px 16px !important;
  font-size: 13px !important;
  font-weight: 500 !important;
  cursor: pointer !important;
  margin-right: 8px !important;
  margin-top: 16px !important;
}

.mdx-editor [role='not-dialog'] button:hover {
  background: var(--vscode-button-hoverBackground) !important;
}

/* Secondary button (Cancel) */
.mdx-editor [role='not-dialog'] button:first-of-type {
  background: var(--vscode-button-secondaryBackground) !important;
  color: var(--vscode-button-secondaryForeground) !important;
}

.mdx-editor [role='not-dialog'] button:first-of-type:hover {
  background: var(--vscode-button-secondaryHoverBackground) !important;
}

/* CodeMirror editor styling in source/diff view */
.mdx-editor .mdxeditor-source-editor .cm-editor,
.mdx-editor .mdxeditor-diff-editor .cm-editor {
  background: var(--vscode-editor-background) !important;
  color: var(--vscode-editor-foreground) !important;
  font-family: var(
    --vscode-editor-font-family,
    'SF Mono',
    Monaco,
    'Cascadia Code',
    'Roboto Mono',
    Consolas,
    'Courier New',
    monospace
  ) !important;
  font-size: var(--vscode-editor-font-size, 13px) !important;
  line-height: var(--vscode-editor-font-weight, 1.4) !important;
  border: none !important;
}

/* CodeMirror content area - VS Code configuration controls word wrap behavior */
.mdx-editor .mdxeditor-source-editor .cm-content,
.mdx-editor .mdxeditor-diff-editor .cm-content {
  background: var(--vscode-editor-background) !important;
  color: var(--vscode-editor-foreground) !important;
  font-family: inherit !important;
  padding: 12px !important;
  min-height: 100% !important;
  padding-bottom: 50vh !important;
}

._toolbarTitleMode_1e2ox_1027 {
  display: none !important;
}

/* CodeMirror scroller - VS Code configuration controls word wrap behavior */
.mdx-editor .mdxeditor-source-editor .cm-scroller,
.mdx-editor .mdxeditor-diff-editor .cm-scroller {
  background: var(--vscode-editor-background) !important;
  font-family: inherit !important;
}

/* CodeMirror line styling - VS Code configuration controls word wrap behavior */
.mdx-editor .mdxeditor-source-editor .cm-line,
.mdx-editor .mdxeditor-diff-editor .cm-line {
  color: var(--vscode-editor-foreground) !important;
  font-family: inherit !important;
}

/* CodeMirror cursor */
.mdx-editor .mdxeditor-source-editor .cm-cursor,
.mdx-editor .mdxeditor-diff-editor .cm-cursor {
  border-left-color: var(--vscode-editorCursor-foreground) !important;
}

/* CodeMirror selection - comprehensive approach with multiple selectors */
.mdx-editor .mdxeditor-source-editor .cm-selectionBackground,
.mdx-editor .mdxeditor-diff-editor .cm-selectionBackground,
.mdx-editor .mdxeditor-source-editor .cm-editor .cm-selectionBackground,
.mdx-editor .mdxeditor-diff-editor .cm-editor .cm-selectionBackground {
  background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Enhanced selection visibility for focused state */
.mdx-editor .mdxeditor-source-editor .cm-focused .cm-selectionBackground,
.mdx-editor .mdxeditor-diff-editor .cm-focused .cm-selectionBackground,
.mdx-editor .mdxeditor-source-editor.cm-focused .cm-selectionBackground,
.mdx-editor .mdxeditor-diff-editor.cm-focused .cm-selectionBackground {
  background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.4)) !important;
}

/* Alternative CodeMirror selection classes */
.mdx-editor .mdxeditor-source-editor .cm-selection,
.mdx-editor .mdxeditor-diff-editor .cm-selection,
.mdx-editor .mdxeditor-source-editor .cm-editor .cm-selection,
.mdx-editor .mdxeditor-diff-editor .cm-editor .cm-selection {
  background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Target any selection-related classes */
.mdx-editor .mdxeditor-source-editor [class*='selection'],
.mdx-editor .mdxeditor-diff-editor [class*='selection'] {
  background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Force selection visibility with high specificity */
.mdx-editor .mdxeditor-source-editor *::selection,
.mdx-editor .mdxeditor-diff-editor *::selection {
  background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
  color: var(--vscode-editor-selectionForeground, inherit) !important;
}

/* CodeMirror Custom Highlight API selection */
.mdx-editor .mdxeditor-source-editor ::highlight(selection),
.mdx-editor .mdxeditor-diff-editor ::highlight(selection) {
  background-color: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Fallback with even more aggressive approach */
.mdx-editor .mdxeditor-source-editor,
.mdx-editor .mdxeditor-diff-editor {
  --cm-selection-background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Force override any existing selection styling */
.mdx-editor .mdxeditor-source-editor .cm-editor,
.mdx-editor .mdxeditor-diff-editor .cm-editor {
  --cm-selection-background: var(--vscode-editor-selectionBackground, rgba(0, 123, 255, 0.3)) !important;
}

/* Ultra-specific targeting */
.mdx-editor .mdxeditor-source-editor .cm-content .cm-line.cm-line,
.mdx-editor .mdxeditor-diff-editor .cm-content .cm-line.cm-line {
  background: transparent !important;
}

.mdx-editor .mdxeditor-source-editor .cm-content .cm-line.cm-line::selection,
.mdx-editor .mdxeditor-diff-editor .cm-content .cm-line.cm-line::selection {
  background: rgba(0, 123, 255, 0.4) !important;
}

/* CodeMirror active line - enhanced with better contrast like rich text editor */
.mdx-editor .mdxeditor-source-editor .cm-activeLine,
.mdx-editor .mdxeditor-diff-editor .cm-activeLine {
  background: rgba(255, 255, 255, 0.04) !important;
}

/* Dark theme specific line highlight for source view - subtle differentiation */
.dark-theme .mdx-editor .mdxeditor-source-editor .cm-activeLine,
.dark-theme .mdx-editor .mdxeditor-diff-editor .cm-activeLine {
  background: rgba(255, 255, 255, 0.06) !important;
}

/* Enhanced bracket matching for source view - theme-aware instead of stark defaults */
.mdx-editor .mdxeditor-source-editor .cm-matchingBracket,
.mdx-editor .mdxeditor-diff-editor .cm-matchingBracket {
  background: var(--vscode-editor-findMatchHighlightBackground) !important;
  color: inherit !important;
  border: 1px solid var(--vscode-editor-findMatchBorder) !important;
  border-radius: 2px !important;
}

.mdx-editor .mdxeditor-source-editor .cm-nonmatchingBracket,
.mdx-editor .mdxeditor-diff-editor .cm-nonmatchingBracket {
  background: var(--vscode-inputValidation-errorBackground) !important;
  color: var(--vscode-inputValidation-errorForeground) !important;
  border: 1px solid var(--vscode-inputValidation-errorBorder) !important;
  border-radius: 2px !important;
}

/* CodeMirror gutters */
.mdx-editor .mdxeditor-source-editor .cm-gutters,
.mdx-editor .mdxeditor-diff-editor .cm-gutters {
  background: var(--vscode-editorGutter-background) !important;
  border-right: 1px solid var(--vscode-editorGutter-border) !important;
  color: var(--vscode-editorLineNumber-foreground) !important;
}

/* CodeMirror line numbers */
.mdx-editor .mdxeditor-source-editor .cm-lineNumbers,
.mdx-editor .mdxeditor-diff-editor .cm-lineNumbers {
  color: var(--vscode-editorLineNumber-foreground) !important;
}

/* CodeMirror active line gutter - enhanced with proper inline style override */
.mdx-editor .mdxeditor-source-editor .cm-activeLineGutter,
.mdx-editor .mdxeditor-diff-editor .cm-activeLineGutter,
.mdx-editor .mdxeditor-source-editor .cm-gutterElement.cm-activeLineGutter,
.mdx-editor .mdxeditor-diff-editor .cm-gutterElement.cm-activeLineGutter {
  background: var(--vscode-editor-lineHighlightBackground) !important;
  color: var(--vscode-editorLineNumber-activeForeground) !important;
}

/* CodeMirror focused state */
.mdx-editor .mdxeditor-source-editor .cm-editor.cm-focused,
.mdx-editor .mdxeditor-diff-editor .cm-editor.cm-focused {
  outline: 1px solid var(--vscode-focusBorder) !important;
  outline-offset: -1px !important;
}

/* Syntax highlighting for source/diff view */
.mdx-editor .mdxeditor-source-editor .cm-keyword,
.mdx-editor .mdxeditor-diff-editor .cm-keyword {
  color: var(--vscode-symbolIcon-keywordForeground, #569cd6) !important;
}

.mdx-editor .mdxeditor-source-editor .cm-string,
.mdx-editor .mdxeditor-diff-editor .cm-string {
  color: var(--vscode-symbolIcon-stringForeground, #ce9178) !important;
}

.mdx-editor .mdxeditor-source-editor .cm-comment,
.mdx-editor .mdxeditor-diff-editor .cm-comment {
  color: var(--vscode-symbolIcon-textForeground, #6a9955) !important;
  font-style: italic !important;
}

.mdx-editor .mdxeditor-source-editor .cm-number,
.mdx-editor .mdxeditor-diff-editor .cm-number {
  color: var(--vscode-symbolIcon-numberForeground, #b5cea8) !important;
}

.mdx-editor .mdxeditor-source-editor .cm-variableName,
.mdx-editor .mdxeditor-diff-editor .cm-variableName {
  color: var(--vscode-symbolIcon-variableForeground, #9cdcfe) !important;
}

.mdx-editor .mdxeditor-source-editor .cm-propertyName,
.mdx-editor .mdxeditor-diff-editor .cm-propertyName {
  color: var(--vscode-symbolIcon-propertyForeground, #9cdcfe) !important;
}

.mdx-editor .mdxeditor-source-editor .cm-punctuation,
.mdx-editor .mdxeditor-diff-editor .cm-punctuation {
  color: var(--vscode-editor-foreground) !important;
}

/* Diff view specific styling */
.mdx-editor .mdxeditor-diff-editor .cm-addedLine {
  background: var(--vscode-diffEditor-insertedTextBackground, rgba(0, 255, 0, 0.2)) !important;
}

.mdx-editor .mdxeditor-diff-editor .cm-deletedLine {
  background: var(--vscode-diffEditor-removedTextBackground, rgba(255, 0, 0, 0.2)) !important;
}

/* Hide markdown parse errors when in source mode */
.mdx-editor-container.source-mode [class*='_markdownParseError_'] {
  display: none !important;
}

[class*='_tableEditor_'] thead > tr > th {
  text-align: center !important;
}
